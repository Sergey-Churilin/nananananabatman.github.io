!function(o){function e(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return o[t].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var n={};e.m=o,e.c=n,e.d=function(o,n,t){e.o(o,n)||Object.defineProperty(o,n,{configurable:!1,enumerable:!0,get:t})},e.n=function(o){var n=o&&o.__esModule?function(){return o.default}:function(){return o};return e.d(n,"a",n),n},e.o=function(o,e){return Object.prototype.hasOwnProperty.call(o,e)},e.p="",e(e.s=2)}([function(o,e,n){"use strict";function t(o,e){if(!(o instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.EmptyBlock=void 0;var r=function(){function o(o,e){for(var n=0;n<e.length;n++){var t=e[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(o,t.key,t)}}return function(e,n,t){return n&&o(e.prototype,n),t&&o(e,t),e}}();n(1),e.EmptyBlock=function(){function o(e,n){t(this,o),this.box=document.createElement("div"),this.box.className="block-empty",this.box.style.width=this.box.style.height=(e/n).toFixed(1)+"px"}return r(o,null,[{key:"changeBlockStyle",value:function(o,e){var n=void 0,t=void 0;switch(e){case 0:n="block-i",t="#81F7F3";break;case 1:n="block-j",t="#8181F7";break;case 2:n="block-l",t="#FE9A2E";break;case 3:n="block-o",t="#F3F781";break;case 4:n="block-s",t="#81F781";break;case 5:n="block-t",t="#DA81F5";break;case 6:n="block-z",t="#F78181";break;default:n="block-empty",t="#D8D8D8"}o.className=n,o.style.backgroundColor=t}}]),o}()},function(o,e,n){"use strict";function t(o,e){if(!(o instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function o(o,e){for(var n=0;n<e.length;n++){var t=e[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(o,t.key,t)}}return function(e,n,t){return n&&o(e.prototype,n),t&&o(e,t),e}}();e.GameBoard=function(){function o(){t(this,o),this.numberOfBlocks=this.checkInputValue(),this.gameBoardSize=550,this.minSpeed=1e3,this.speedReduction=500}return r(o,[{key:"checkInputValue",value:function(){var o=+document.querySelector("#number").value;return o>=9&&o<=15?o:9}}]),o}()},function(o,e,n){"use strict";function t(o){if(Array.isArray(o)){for(var e=0,n=Array(o.length);e<o.length;e++)n[e]=o[e];return n}return Array.from(o)}function r(){(y||h)&&(document.body.removeChild(y),clearInterval(h)),w=new k.GameBoard,s=[],p=[],v=parseInt(localStorage.getItem("currentScore"))||0,E=document.getElementById("score"),E.innerText=v||0,x=2500,B=!0,l(),a(),function(){function o(){for(var o=0;o<s.length;++o)!function(o){s[o].map(function(o){return o.className}).includes("block-empty")||(v+=w.numberOfBlocks,E.innerText=v,x=x===w.minSpeed?x:x-w.speedReduction,localStorage.setItem("currentScore",v),p.map(function(o){return i(o.block)}),p.forEach(function(e){return e.block=e.block.filter(function(e){return e.coord[0]!==o})}),p=p.filter(function(o){return 0!==o.block.length}),p.map(function(o){return i(o.block,o.index)}))}(o)}h=setInterval(function(){p.forEach(function(e,n){f(e.block,[1,0])?d(e,0,1):(n===p.length-1&&B&&a(),o())})},x)}(),document.addEventListener("keydown",c)}function c(o){37===o.keyCode&&f(p[p.length-1].block,[0,-1])?d(p[p.length-1],1,-1):39===o.keyCode&&f(p[p.length-1].block,[0,1])&&d(p[p.length-1],1,1)}function l(){y=document.createElement("div"),y.className="game";for(var o=0;o<w.numberOfBlocks;++o){s.push([]);for(var e=0;e<w.numberOfBlocks;++e)s[o][e]=new m.EmptyBlock(w.gameBoardSize,w.numberOfBlocks).box,y.appendChild(s[o][e]),m.EmptyBlock.changeBlockStyle(s[o][e])}document.body.appendChild(y)}function a(){var o=new b.Element,e=o.block.map(function(o){return o.coord[1]}),n=Math.floor((w.numberOfBlocks-Math.max.apply(Math,t(e)))/2);o.block=o.block.map(function(o){return{box:o.box,coord:[o.coord[0],o.coord[1]+n]}}),!function(o){var e=!0;return o.block.forEach(function(o){return e=e&&u(o.coord)}),e}(o)?(document.removeEventListener("keydown",c),o.paintLastElement(),localStorage.removeItem("currentScore"),B=!1,clearInterval(h)):(p.push(o),i(p[p.length-1].block,p[p.length-1].index))}function u(o){try{return"block-empty"===s[o[0]][o[1]].className}catch(o){return!1}}function i(o,e){o.map(function(o){m.EmptyBlock.changeBlockStyle(s[o.coord[0]][o.coord[1]],e)})}function d(o,e,n){i(o.block),o.block.map(function(o){return o.coord[e]+=n}),i(o.block,o.index)}function f(o,e){var n=o.map(function(o){return[o.coord[0]+e[0],o.coord[1]+e[1]]}),t=!0;return n.forEach(function(e){o.map(function(o){return o.coord.toString()}).includes(e.toString())||(t=t&&u(e))}),t}var b=n(3),m=n(0),k=n(1);document.querySelector("#start").addEventListener("click",r);var s=void 0,p=void 0,y=void 0,h=void 0,v=void 0,E=void 0,x=void 0,B=void 0,w=void 0},function(o,e,n){"use strict";function t(o,e){if(!(o instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.Element=void 0;var r=function(){function o(o,e){for(var n=0;n<e.length;n++){var t=e[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(o,t.key,t)}}return function(e,n,t){return n&&o(e.prototype,n),t&&o(e,t),e}}(),c=n(0),l=[[{coord:[0,0],box:new c.EmptyBlock},{coord:[0,1],box:new c.EmptyBlock},{coord:[0,2],box:new c.EmptyBlock},{coord:[0,3],box:new c.EmptyBlock}],[{coord:[0,0],box:new c.EmptyBlock},{coord:[0,1],box:new c.EmptyBlock},{coord:[0,2],box:new c.EmptyBlock},{coord:[1,2],box:new c.EmptyBlock}],[{coord:[0,0],box:new c.EmptyBlock},{coord:[0,1],box:new c.EmptyBlock},{coord:[0,2],box:new c.EmptyBlock},{coord:[1,0],box:new c.EmptyBlock}],[{coord:[0,0],box:new c.EmptyBlock},{coord:[0,1],box:new c.EmptyBlock},{coord:[1,0],box:new c.EmptyBlock},{coord:[1,1],box:new c.EmptyBlock}],[{coord:[0,1],box:new c.EmptyBlock},{coord:[0,2],box:new c.EmptyBlock},{coord:[1,0],box:new c.EmptyBlock},{coord:[1,1],box:new c.EmptyBlock}],[{coord:[0,0],box:new c.EmptyBlock},{coord:[0,1],box:new c.EmptyBlock},{coord:[0,2],box:new c.EmptyBlock},{coord:[1,1],box:new c.EmptyBlock}],[{coord:[0,0],box:new c.EmptyBlock},{coord:[0,1],box:new c.EmptyBlock},{coord:[1,1],box:new c.EmptyBlock},{coord:[1,2],box:new c.EmptyBlock}]];e.Element=function(){function o(){t(this,o),this.index=Math.floor(7*Math.random()),this.block=l[this.index]}return r(o,[{key:"paintLastElement",value:function(){var o=this;this.block.map(function(e){return c.EmptyBlock.changeBlockStyle(e.box.box,o.index)})}}]),o}()}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZGlzdC9idW5kbGUuanMiLCJ3ZWJwYWNrOi8vL3dlYnBhY2svYm9vdHN0cmFwIDk4YjQ1MzJkYjIyYjU5NzkyMGU4Iiwid2VicGFjazovLy8uL3NjcmlwdHMvRW1wdHlCbG9jay5jbGFzcy5qcyIsIndlYnBhY2s6Ly8vLi9zY3JpcHRzL0dhbWVCb2FyZC5jbGFzcy5qcyIsIndlYnBhY2s6Ly8vLi9zY3JpcHRzL2luZGV4LmpzIiwid2VicGFjazovLy8uL3NjcmlwdHMvRWxlbWVudC5jbGFzcy5qcyJdLCJuYW1lcyI6WyJtb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiaW5zdGFsbGVkTW9kdWxlcyIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiY29uZmlndXJhYmxlIiwiZW51bWVyYWJsZSIsImdldCIsIm4iLCJfX2VzTW9kdWxlIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiX2NsYXNzQ2FsbENoZWNrIiwiaW5zdGFuY2UiLCJDb25zdHJ1Y3RvciIsIlR5cGVFcnJvciIsInZhbHVlIiwiRW1wdHlCbG9jayIsInVuZGVmaW5lZCIsIl9jcmVhdGVDbGFzcyIsImRlZmluZVByb3BlcnRpZXMiLCJ0YXJnZXQiLCJwcm9wcyIsImxlbmd0aCIsImRlc2NyaXB0b3IiLCJ3cml0YWJsZSIsImtleSIsInByb3RvUHJvcHMiLCJzdGF0aWNQcm9wcyIsImJvYXJkU2l6ZSIsIm51bWJlck9mQmxvY2tzIiwidGhpcyIsImJveCIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTmFtZSIsInN0eWxlIiwid2lkdGgiLCJoZWlnaHQiLCJ0b0ZpeGVkIiwiYmxvY2tPblBhZ2UiLCJzdHlsZUJsb2NrIiwiZWxDbGFzcyIsImNvbG9yIiwiYmFja2dyb3VuZENvbG9yIiwiR2FtZUJvYXJkIiwiY2hlY2tJbnB1dFZhbHVlIiwiZ2FtZUJvYXJkU2l6ZSIsIm1pblNwZWVkIiwic3BlZWRSZWR1Y3Rpb24iLCJxdWVyeVNlbGVjdG9yIiwiX3RvQ29uc3VtYWJsZUFycmF5IiwiYXJyIiwiQXJyYXkiLCJpc0FycmF5IiwiYXJyMiIsImZyb20iLCJpbml0IiwiZ2FtZUJvYXJkIiwiaW50ZXJ2YWxJRCIsImJvZHkiLCJyZW1vdmVDaGlsZCIsImNsZWFySW50ZXJ2YWwiLCJib2FyZCIsIl9HYW1lQm9hcmQiLCJibG9ja3NPblBhZ2UiLCJlbGVtZW50cyIsInNjb3JlIiwicGFyc2VJbnQiLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwic2NvcmVFbGVtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJpbm5lclRleHQiLCJzcGVlZCIsInRoZUdhbWVJc05vdEZpbmlzaGVkIiwiZHJhd0dhbWVCb2FyZCIsImFkZE5ld0VsZW1lbnQiLCJjaGVja1Njb3JlIiwibWFwIiwiaXRlbSIsImluY2x1ZGVzIiwic2V0SXRlbSIsImRyYXdFbGVtZW50IiwiYmxvY2siLCJmb3JFYWNoIiwiZmlsdGVyIiwiZWxlbSIsImNvb3JkIiwiaW5kZXgiLCJzZXRJbnRlcnZhbCIsImNhbk1vdmVFbGVtZW50IiwibW92ZUJsb2NrIiwiYWRkRXZlbnRMaXN0ZW5lciIsImV4ZWN1dGVLZXlEb3duQWN0aW9uIiwiZXZlbnQiLCJrZXlDb2RlIiwicHVzaCIsImoiLCJfRW1wdHlCbG9jayIsImFwcGVuZENoaWxkIiwiY2hhbmdlQmxvY2tTdHlsZSIsIm5ld0VsZW0iLCJfRWxlbWVudCIsIkVsZW1lbnQiLCJwb2ludHNYT2ZOZXdFbGVtIiwibWlkZGxlIiwiTWF0aCIsImZsb29yIiwibWF4IiwiYXBwbHkiLCJlbGVtZW50IiwiY2FuQWRkIiwidHJ5QWRkQmxvY2siLCJyZW1vdmVFdmVudExpc3RlbmVyIiwicGFpbnRMYXN0RWxlbWVudCIsInJlbW92ZUl0ZW0iLCJlcnIiLCJwb3NpdGlvbiIsInNoaWZ0IiwicGVyaGFic05ld1Bvc2l0aW9uIiwiY2FuTW92ZSIsInRvU3RyaW5nIiwiQkxPQ0tTIiwicmFuZG9tIiwiX3RoaXMiXSwibWFwcGluZ3MiOiJDQUFTLFNBQVVBLEdDSW5CLFFBQUFDLEdBQUFDLEdBR0EsR0FBQUMsRUFBQUQsR0FDQSxNQUFBQyxHQUFBRCxHQUFBRSxPQUdBLElBQUFDLEdBQUFGLEVBQUFELElBQ0FJLEVBQUFKLEVBQ0FLLEdBQUEsRUFDQUgsV0FVQSxPQU5BSixHQUFBRSxHQUFBTSxLQUFBSCxFQUFBRCxRQUFBQyxJQUFBRCxRQUFBSCxHQUdBSSxFQUFBRSxHQUFBLEVBR0FGLEVBQUFELFFBdkJBLEdBQUFELEtBNEJBRixHQUFBUSxFQUFBVCxFQUdBQyxFQUFBUyxFQUFBUCxFQUdBRixFQUFBVSxFQUFBLFNBQUFQLEVBQUFRLEVBQUFDLEdBQ0FaLEVBQUFhLEVBQUFWLEVBQUFRLElBQ0FHLE9BQUFDLGVBQUFaLEVBQUFRLEdBQ0FLLGNBQUEsRUFDQUMsWUFBQSxFQUNBQyxJQUFBTixLQU1BWixFQUFBbUIsRUFBQSxTQUFBZixHQUNBLEdBQUFRLEdBQUFSLEtBQUFnQixXQUNBLFdBQTJCLE1BQUFoQixHQUFBLFNBQzNCLFdBQWlDLE1BQUFBLEdBRWpDLE9BREFKLEdBQUFVLEVBQUFFLEVBQUEsSUFBQUEsR0FDQUEsR0FJQVosRUFBQWEsRUFBQSxTQUFBUSxFQUFBQyxHQUFzRCxNQUFBUixRQUFBUyxVQUFBQyxlQUFBakIsS0FBQWMsRUFBQUMsSUFHdER0QixFQUFBeUIsRUFBQSxHQUdBekIsSUFBQTBCLEVBQUEsS0RNTSxTQUFVdEIsRUFBUUQsRUFBU0gsR0FFakMsWUFZQSxTQUFTMkIsR0FBZ0JDLEVBQVVDLEdBQWUsS0FBTUQsWUFBb0JDLElBQWdCLEtBQU0sSUFBSUMsV0FBVSxxQ0FUaEhoQixPQUFPQyxlQUFlWixFQUFTLGNBQzNCNEIsT0FBTyxJQUVYNUIsRUFBUTZCLGVBQWFDLEVBRXJCLElBQUlDLEdBQWUsV0FBYyxRQUFTQyxHQUFpQkMsRUFBUUMsR0FBUyxJQUFL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RCxJQUFLLEdBQUFtRSxHQUFBbEYsYUFDcEJ1RSxPQUFRLEVBQUcsR0FBSXhELElBQUssR0FBQW1FLEdBQUFsRixhQUNwQnVFLE9BQVEsRUFBRyxHQUFJeEQsSUFBSyxHQUFBbUUsR0FBQWxGLGFBQ3BCdUUsT0FBUSxFQUFHLEdBQUl4RCxJQUFLLEdBQUFtRSxHQUFBbEYsZUFFcEJ1RSxPQUFRLEVBQUcsR0FBSXhELElBQUssR0FBQW1FLEdBQUFsRixhQUNwQnVFLE9BQVEsRUFBRyxHQUFJeEQsSUFBSyxHQUFBbUUsR0FBQWxGLGFBQ3BCdUUsT0FBUSxFQUFHLEdBQUl4RCxJQUFLLEdBQUFtRSxHQUFBbEYsYUFDcEJ1RSxPQUFRLEVBQUcsR0FBSXhELElBQUssR0FBQW1FLEdBQUFsRixlQUVwQnVFLE9BQVEsRUFBRyxHQUFJeEQsSUFBSyxHQUFBbUUsR0FBQWxGLGFBQ3BCdUUsT0FBUSxFQUFHLEdBQUl4RCxJQUFLLEdBQUFtRSxHQUFBbEYsYUFDcEJ1RSxPQUFRLEVBQUcsR0FBSXhELElBQUssR0FBQW1FLEdBQUFsRixhQUNwQnVFLE9BQVEsRUFBRyxHQUFJeEQsSUFBSyxHQUFBbUUsR0FBQWxGLGVBRXBCdUUsT0FBUSxFQUFHLEdBQUl4RCxJQUFLLEdBQUFtRSxHQUFBbEYsYUFDcEJ1RSxPQUFRLEVBQUcsR0FBSXhELElBQUssR0FBQW1FLEdBQUFsRixhQUNwQnVFLE9BQVEsRUFBRyxHQUFJeEQsSUFBSyxHQUFBbUUsR0FBQWxGLGFBQ3BCdUUsT0FBUSxFQUFHLEdBQUl4RCxJQUFLLEdBQUFtRSxHQUFBbEYsZUFFcEJ1RSxPQUFRLEVBQUcsR0FBSXhELElBQUssR0FBQW1FLEdBQUFsRixhQUNwQnVFLE9BQVEsRUFBRyxHQUFJeEQsSUFBSyxHQUFBbUUsR0FBQWxGLGFBQ3BCdUUsT0FBUSxFQUFHLEdBQUl4RCxJQUFLLEdBQUFtRSxHQUFBbEYsYUFDcEJ1RSxPQUFRLEVBQUcsR0FBSXhELElBQUssR0FBQW1FLEdBQUFsRixlQUVwQnVFLE9BQVEsRUFBRyxHQUFJeEQsSUFBSyxHQUFBbUUsR0FBQWxGLGFBQ3BCdUUsT0FBUSxFQUFHLEdBQUl4RCxJQUFLLEdBQUFtRSxHQUFBbEYsYUFDcEJ1RSxPQUFRLEVBQUcsR0FBSXhELElBQUssR0FBQW1FLEdBQUFsRixhQUNwQnVFLE9BQVEsRUFBRyxHQUFJeEQsSUFBSyxHQUFBbUUsR0FBQWxGLGVBRXBCdUUsT0FBUSxFQUFHLEdBQUl4RCxJQUFLLEdBQUFtRSxHQUFBbEYsYUFDcEJ1RSxPQUFRLEVBQUcsR0FBSXhELElBQUssR0FBQW1FLEdBQUFsRixhQUNwQnVFLE9BQVEsRUFBRyxHQUFJeEQsSUFBSyxHQUFBbUUsR0FBQWxGLGFBQ3BCdUUsT0FBUSxFQUFHLEdBQUl4RCxJQUFLLEdBQUFtRSxHQUFBbEYsYUxvVlg3QixHS2pWRG9ILFFMaVZtQixXS2hWNUIsUUFBQUEsS0FBYzVGLEVBQUFtQixLQUFBeUUsR0FDVnpFLEtBQUswRCxNQUFRa0IsS0FBS0MsTUFBc0IsRUFBaEJELEtBQUtpQixVQUM3QjdGLEtBQUtxRCxNQUFRdUMsRUFBTzVGLEtBQUswRCxPTG1YN0IsTUE5QkF0RSxHQUFhcUYsSUFDVDlFLElBQUssbUJBQ0xWLE1BQU8sV0twVlEsR0FBQTZHLEdBQUE5RixJQUNmQSxNQUFLcUQsTUFBTUwsSUFBSSxTQUFBQyxHQUFBLE1BQVFtQixHQUFBbEYsV0FBV29GLGlCQUFpQnJCLEVBQUtoRCxJQUFJQSxJQUFLNkYsRUFBS3BDLGFMK1duRWUiLCJmaWxlIjoiLi9kaXN0L2J1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKioqKiovIChmdW5jdGlvbihtb2R1bGVzKSB7IC8vIHdlYnBhY2tCb290c3RyYXBcbi8qKioqKiovIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbi8qKioqKiovIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbi8qKioqKiovIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuLyoqKioqKi8gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4vKioqKioqLyBcdFx0fVxuLyoqKioqKi8gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4vKioqKioqLyBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuLyoqKioqKi8gXHRcdFx0aTogbW9kdWxlSWQsXG4vKioqKioqLyBcdFx0XHRsOiBmYWxzZSxcbi8qKioqKiovIFx0XHRcdGV4cG9ydHM6IHt9XG4vKioqKioqLyBcdFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4vKioqKioqLyBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbi8qKioqKiovIFx0XHRtb2R1bGUubCA9IHRydWU7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4vKioqKioqLyBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuLyoqKioqKi8gXHR9XG4vKioqKioqL1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4vKioqKioqLyBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuLyoqKioqKi8gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHtcbi8qKioqKiovIFx0XHRcdFx0Y29uZmlndXJhYmxlOiBmYWxzZSxcbi8qKioqKiovIFx0XHRcdFx0ZW51bWVyYWJsZTogdHJ1ZSxcbi8qKioqKiovIFx0XHRcdFx0Z2V0OiBnZXR0ZXJcbi8qKioqKiovIFx0XHRcdH0pO1xuLyoqKioqKi8gXHRcdH1cbi8qKioqKiovIFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuLyoqKioqKi8gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuLyoqKioqKi8gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbi8qKioqKiovIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4vKioqKioqLyBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuLyoqKioqKi8gXHRcdHJldHVybiBnZXR0ZXI7XG4vKioqKioqLyBcdH07XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLyoqKioqKi8gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAyKTtcbi8qKioqKiovIH0pXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuLyoqKioqKi8gKFtcbi8qIDAgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXCJ1c2Ugc3RyaWN0XCI7XG5cblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5FbXB0eUJsb2NrID0gdW5kZWZpbmVkO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG52YXIgX0dhbWVCb2FyZCA9IF9fd2VicGFja19yZXF1aXJlX18oMSk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbnZhciBFbXB0eUJsb2NrID0gZXhwb3J0cy5FbXB0eUJsb2NrID0gZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEVtcHR5QmxvY2soYm9hcmRTaXplLCBudW1iZXJPZkJsb2Nrcykge1xuICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRW1wdHlCbG9jayk7XG5cbiAgICAgICAgdGhpcy5ib3ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgdGhpcy5ib3guY2xhc3NOYW1lID0gJ2Jsb2NrLWVtcHR5JztcbiAgICAgICAgdGhpcy5ib3guc3R5bGUud2lkdGggPSB0aGlzLmJveC5zdHlsZS5oZWlnaHQgPSAoYm9hcmRTaXplIC8gbnVtYmVyT2ZCbG9ja3MpLnRvRml4ZWQoMSkgKyAncHgnO1xuICAgIH1cblxuICAgIF9jcmVhdGVDbGFzcyhFbXB0eUJsb2NrLCBudWxsLCBbe1xuICAgICAgICBrZXk6ICdjaGFuZ2VCbG9ja1N0eWxlJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNoYW5nZUJsb2NrU3R5bGUoYmxvY2tPblBhZ2UsIHN0eWxlQmxvY2spIHtcbiAgICAgICAgICAgIHZhciBlbENsYXNzID0gdm9pZCAwLFxuICAgICAgICAgICAgICAgIGNvbG9yID0gdm9pZCAwO1xuXG4gICAgICAgICAgICBzd2l0Y2ggKHN0eWxlQmxvY2spIHtcbiAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgIGVsQ2xhc3MgPSAnYmxvY2staSc7Y29sb3IgPSAnIzgxRjdGMyc7YnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICBlbENsYXNzID0gJ2Jsb2NrLWonO2NvbG9yID0gJyM4MTgxRjcnO2JyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgZWxDbGFzcyA9ICdibG9jay1sJztjb2xvciA9ICcjRkU5QTJFJzticmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgIGVsQ2xhc3MgPSAnYmxvY2stbyc7Y29sb3IgPSAnI0YzRjc4MSc7YnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICBlbENsYXNzID0gJ2Jsb2NrLXMnO2NvbG9yID0gJyM4MUY3ODEnO2JyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgNTpcbiAgICAgICAgICAgICAgICAgICAgZWxDbGFzcyA9ICdibG9jay10Jztjb2xvciA9ICcjREE4MUY1JzticmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDY6XG4gICAgICAgICAgICAgICAgICAgIGVsQ2xhc3MgPSAnYmxvY2steic7Y29sb3IgPSAnI0Y3ODE4MSc7YnJlYWs7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgZWxDbGFzcyA9ICdibG9jay1lbXB0eSc7Y29sb3IgPSAnI0Q4RDhEOCc7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGJsb2NrT25QYWdlLmNsYXNzTmFtZSA9IGVsQ2xhc3M7XG4gICAgICAgICAgICBibG9ja09uUGFnZS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBjb2xvcjtcbiAgICAgICAgfVxuICAgIH1dKTtcblxuICAgIHJldHVybiBFbXB0eUJsb2NrO1xufSgpO1xuXG4vKioqLyB9KSxcbi8qIDEgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXCJ1c2Ugc3RyaWN0XCI7XG5cblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG52YXIgR2FtZUJvYXJkID0gZXhwb3J0cy5HYW1lQm9hcmQgPSBmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gR2FtZUJvYXJkKCkge1xuICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgR2FtZUJvYXJkKTtcblxuICAgICAgICB0aGlzLm51bWJlck9mQmxvY2tzID0gdGhpcy5jaGVja0lucHV0VmFsdWUoKTtcbiAgICAgICAgdGhpcy5nYW1lQm9hcmRTaXplID0gNTUwO1xuICAgICAgICB0aGlzLm1pblNwZWVkID0gMTAwMDtcbiAgICAgICAgdGhpcy5zcGVlZFJlZHVjdGlvbiA9IDUwMDtcbiAgICB9XG5cbiAgICBfY3JlYXRlQ2xhc3MoR2FtZUJvYXJkLCBbe1xuICAgICAgICBrZXk6ICdjaGVja0lucHV0VmFsdWUnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY2hlY2tJbnB1dFZhbHVlKCkge1xuICAgICAgICAgICAgdmFyIHZhbHVlID0gK2RvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNudW1iZXInKS52YWx1ZTtcblxuICAgICAgICAgICAgcmV0dXJuIHZhbHVlID49IDkgJiYgdmFsdWUgPD0gMTUgPyB2YWx1ZSA6IDk7XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gR2FtZUJvYXJkO1xufSgpO1xuXG4vKioqLyB9KSxcbi8qIDIgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXCJ1c2Ugc3RyaWN0XCI7XG5cblxudmFyIF9FbGVtZW50ID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTtcblxudmFyIF9FbXB0eUJsb2NrID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcblxudmFyIF9HYW1lQm9hcmQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpO1xuXG5mdW5jdGlvbiBfdG9Db25zdW1hYmxlQXJyYXkoYXJyKSB7IGlmIChBcnJheS5pc0FycmF5KGFycikpIHsgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBBcnJheShhcnIubGVuZ3RoKTsgaSA8IGFyci5sZW5ndGg7IGkrKykgeyBhcnIyW2ldID0gYXJyW2ldOyB9IHJldHVybiBhcnIyOyB9IGVsc2UgeyByZXR1cm4gQXJyYXkuZnJvbShhcnIpOyB9IH1cblxuZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3N0YXJ0JykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBpbml0KTtcblxudmFyIGJsb2Nrc09uUGFnZSA9IHZvaWQgMCxcbiAgICBlbGVtZW50cyA9IHZvaWQgMCxcbiAgICBnYW1lQm9hcmQgPSB2b2lkIDAsXG4gICAgaW50ZXJ2YWxJRCA9IHZvaWQgMCxcbiAgICBzY29yZSA9IHZvaWQgMCxcbiAgICBzY29yZUVsZW1lbnQgPSB2b2lkIDAsXG4gICAgc3BlZWQgPSB2b2lkIDAsXG4gICAgdGhlR2FtZUlzTm90RmluaXNoZWQgPSB2b2lkIDAsXG4gICAgYm9hcmQgPSB2b2lkIDA7XG5cbmZ1bmN0aW9uIGluaXQoKSB7XG4gICAgZnVuY3Rpb24gc3RhcnRHYW1lKCkge1xuICAgICAgICBmdW5jdGlvbiBjaGVja1Njb3JlKCkge1xuICAgICAgICAgICAgdmFyIF9sb29wID0gZnVuY3Rpb24gX2xvb3AoaSkge1xuICAgICAgICAgICAgICAgIGlmICghYmxvY2tzT25QYWdlW2ldLm1hcChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXRlbS5jbGFzc05hbWU7XG4gICAgICAgICAgICAgICAgfSkuaW5jbHVkZXMoJ2Jsb2NrLWVtcHR5JykpIHtcbiAgICAgICAgICAgICAgICAgICAgc2NvcmUgKz0gYm9hcmQubnVtYmVyT2ZCbG9ja3M7XG4gICAgICAgICAgICAgICAgICAgIHNjb3JlRWxlbWVudC5pbm5lclRleHQgPSBzY29yZTtcbiAgICAgICAgICAgICAgICAgICAgc3BlZWQgPSBzcGVlZCA9PT0gYm9hcmQubWluU3BlZWQgPyBzcGVlZCA6IHNwZWVkIC0gYm9hcmQuc3BlZWRSZWR1Y3Rpb247XG4gICAgICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdjdXJyZW50U2NvcmUnLCBzY29yZSk7XG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnRzLm1hcChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRyYXdFbGVtZW50KGl0ZW0uYmxvY2spO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudHMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0uYmxvY2sgPSBpdGVtLmJsb2NrLmZpbHRlcihmdW5jdGlvbiAoZWxlbSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBlbGVtLmNvb3JkWzBdICE9PSBpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBlbGVtZW50cyA9IGVsZW1lbnRzLmZpbHRlcihmdW5jdGlvbiAoZWxlbSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVsZW0uYmxvY2subGVuZ3RoICE9PSAwO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudHMubWFwKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZHJhd0VsZW1lbnQoaXRlbS5ibG9jaywgaXRlbS5pbmRleCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYmxvY2tzT25QYWdlLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICAgICAgX2xvb3AoaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpbnRlcnZhbElEID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZWxlbWVudHMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSwgaW5kZXgpIHtcbiAgICAgICAgICAgICAgICBpZiAoY2FuTW92ZUVsZW1lbnQoaXRlbS5ibG9jaywgWzEsIDBdKSkge1xuICAgICAgICAgICAgICAgICAgICBtb3ZlQmxvY2soaXRlbSwgMCwgMSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGluZGV4ID09PSBlbGVtZW50cy5sZW5ndGggLSAxICYmIHRoZUdhbWVJc05vdEZpbmlzaGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhZGROZXdFbGVtZW50KCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2hlY2tTY29yZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LCBzcGVlZCk7XG4gICAgfVxuXG4gICAgaWYgKGdhbWVCb2FyZCB8fCBpbnRlcnZhbElEKSB7XG4gICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoZ2FtZUJvYXJkKTtcbiAgICAgICAgY2xlYXJJbnRlcnZhbChpbnRlcnZhbElEKTtcbiAgICB9XG5cbiAgICBib2FyZCA9IG5ldyBfR2FtZUJvYXJkLkdhbWVCb2FyZCgpO1xuICAgIGJsb2Nrc09uUGFnZSA9IFtdO1xuICAgIGVsZW1lbnRzID0gW107XG4gICAgc2NvcmUgPSBwYXJzZUludChsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnY3VycmVudFNjb3JlJykpIHx8IDA7XG4gICAgc2NvcmVFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Njb3JlJyk7XG4gICAgc2NvcmVFbGVtZW50LmlubmVyVGV4dCA9IHNjb3JlIHx8IDA7XG4gICAgc3BlZWQgPSAyNTAwO1xuICAgIHRoZUdhbWVJc05vdEZpbmlzaGVkID0gdHJ1ZTtcblxuICAgIGRyYXdHYW1lQm9hcmQoKTtcbiAgICBhZGROZXdFbGVtZW50KCk7XG4gICAgc3RhcnRHYW1lKCk7XG5cbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgZXhlY3V0ZUtleURvd25BY3Rpb24pO1xufVxuXG5mdW5jdGlvbiBleGVjdXRlS2V5RG93bkFjdGlvbihldmVudCkge1xuICAgIGlmIChldmVudC5rZXlDb2RlID09PSAzNyAmJiBjYW5Nb3ZlRWxlbWVudChlbGVtZW50c1tlbGVtZW50cy5sZW5ndGggLSAxXS5ibG9jaywgWzAsIC0xXSkpIHtcbiAgICAgICAgbW92ZUJsb2NrKGVsZW1lbnRzW2VsZW1lbnRzLmxlbmd0aCAtIDFdLCAxLCAtMSk7XG4gICAgfSBlbHNlIGlmIChldmVudC5rZXlDb2RlID09PSAzOSAmJiBjYW5Nb3ZlRWxlbWVudChlbGVtZW50c1tlbGVtZW50cy5sZW5ndGggLSAxXS5ibG9jaywgWzAsIDFdKSkge1xuICAgICAgICBtb3ZlQmxvY2soZWxlbWVudHNbZWxlbWVudHMubGVuZ3RoIC0gMV0sIDEsIDEpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gZHJhd0dhbWVCb2FyZCgpIHtcbiAgICBnYW1lQm9hcmQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBnYW1lQm9hcmQuY2xhc3NOYW1lID0gJ2dhbWUnO1xuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBib2FyZC5udW1iZXJPZkJsb2NrczsgKytpKSB7XG4gICAgICAgIGJsb2Nrc09uUGFnZS5wdXNoKFtdKTtcbiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBib2FyZC5udW1iZXJPZkJsb2NrczsgKytqKSB7XG4gICAgICAgICAgICBibG9ja3NPblBhZ2VbaV1bal0gPSBuZXcgX0VtcHR5QmxvY2suRW1wdHlCbG9jayhib2FyZC5nYW1lQm9hcmRTaXplLCBib2FyZC5udW1iZXJPZkJsb2NrcykuYm94O1xuICAgICAgICAgICAgZ2FtZUJvYXJkLmFwcGVuZENoaWxkKGJsb2Nrc09uUGFnZVtpXVtqXSk7XG4gICAgICAgICAgICBfRW1wdHlCbG9jay5FbXB0eUJsb2NrLmNoYW5nZUJsb2NrU3R5bGUoYmxvY2tzT25QYWdlW2ldW2pdKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZ2FtZUJvYXJkKTtcbn1cblxuZnVuY3Rpb24gYWRkTmV3RWxlbWVudCgpIHtcbiAgICB2YXIgbmV3RWxlbSA9IG5ldyBfRWxlbWVudC5FbGVtZW50KCksXG4gICAgICAgIHBvaW50c1hPZk5ld0VsZW0gPSBuZXdFbGVtLmJsb2NrLm1hcChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICByZXR1cm4gaXRlbS5jb29yZFsxXTtcbiAgICB9KSxcbiAgICAgICAgbWlkZGxlID0gTWF0aC5mbG9vcigoYm9hcmQubnVtYmVyT2ZCbG9ja3MgLSBNYXRoLm1heC5hcHBseShNYXRoLCBfdG9Db25zdW1hYmxlQXJyYXkocG9pbnRzWE9mTmV3RWxlbSkpKSAvIDIpO1xuXG4gICAgZnVuY3Rpb24gY2FuQWRkQW5vdGhlckJsb2NrKGVsZW1lbnQpIHtcbiAgICAgICAgdmFyIGNhbkFkZCA9IHRydWU7XG5cbiAgICAgICAgZWxlbWVudC5ibG9jay5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICByZXR1cm4gY2FuQWRkID0gY2FuQWRkICYmIHRyeUFkZEJsb2NrKGl0ZW0uY29vcmQpO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gY2FuQWRkO1xuICAgIH1cblxuICAgIG5ld0VsZW0uYmxvY2sgPSBuZXdFbGVtLmJsb2NrLm1hcChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgYm94OiBpdGVtLmJveCxcbiAgICAgICAgICAgIGNvb3JkOiBbaXRlbS5jb29yZFswXSwgaXRlbS5jb29yZFsxXSArIG1pZGRsZV1cbiAgICAgICAgfTtcbiAgICB9KTtcblxuICAgIGlmIChjYW5BZGRBbm90aGVyQmxvY2sobmV3RWxlbSkpIHtcbiAgICAgICAgZWxlbWVudHMucHVzaChuZXdFbGVtKTtcbiAgICAgICAgZHJhd0VsZW1lbnQoZWxlbWVudHNbZWxlbWVudHMubGVuZ3RoIC0gMV0uYmxvY2ssIGVsZW1lbnRzW2VsZW1lbnRzLmxlbmd0aCAtIDFdLmluZGV4KTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgZXhlY3V0ZUtleURvd25BY3Rpb24pO1xuICAgICAgICBuZXdFbGVtLnBhaW50TGFzdEVsZW1lbnQoKTtcbiAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ2N1cnJlbnRTY29yZScpO1xuICAgICAgICB0aGVHYW1lSXNOb3RGaW5pc2hlZCA9IGZhbHNlO1xuICAgICAgICBjbGVhckludGVydmFsKGludGVydmFsSUQpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gdHJ5QWRkQmxvY2soYmxvY2spIHtcbiAgICB0cnkge1xuICAgICAgICByZXR1cm4gYmxvY2tzT25QYWdlW2Jsb2NrWzBdXVtibG9ja1sxXV0uY2xhc3NOYW1lID09PSAnYmxvY2stZW1wdHknO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBkcmF3RWxlbWVudChibG9jaywgaW5kZXgpIHtcbiAgICBibG9jay5tYXAoZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgX0VtcHR5QmxvY2suRW1wdHlCbG9jay5jaGFuZ2VCbG9ja1N0eWxlKGJsb2Nrc09uUGFnZVtpdGVtLmNvb3JkWzBdXVtpdGVtLmNvb3JkWzFdXSwgaW5kZXgpO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBtb3ZlQmxvY2soZWxlbWVudCwgcG9zaXRpb24sIHNoaWZ0KSB7XG4gICAgZHJhd0VsZW1lbnQoZWxlbWVudC5ibG9jayk7XG4gICAgZWxlbWVudC5ibG9jay5tYXAoZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgcmV0dXJuIGl0ZW0uY29vcmRbcG9zaXRpb25dICs9IHNoaWZ0O1xuICAgIH0pO1xuICAgIGRyYXdFbGVtZW50KGVsZW1lbnQuYmxvY2ssIGVsZW1lbnQuaW5kZXgpO1xufVxuXG5mdW5jdGlvbiBjYW5Nb3ZlRWxlbWVudChibG9jaywgc2hpZnQpIHtcbiAgICB2YXIgcGVyaGFic05ld1Bvc2l0aW9uID0gYmxvY2subWFwKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgIHJldHVybiBbaXRlbS5jb29yZFswXSArIHNoaWZ0WzBdLCBpdGVtLmNvb3JkWzFdICsgc2hpZnRbMV1dO1xuICAgIH0pLFxuICAgICAgICBjYW5Nb3ZlID0gdHJ1ZTtcblxuICAgIHBlcmhhYnNOZXdQb3NpdGlvbi5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgIGlmICghYmxvY2subWFwKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICByZXR1cm4gaXRlbS5jb29yZC50b1N0cmluZygpO1xuICAgICAgICB9KS5pbmNsdWRlcyhpdGVtLnRvU3RyaW5nKCkpKSB7XG4gICAgICAgICAgICBjYW5Nb3ZlID0gY2FuTW92ZSAmJiB0cnlBZGRCbG9jayhpdGVtKTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIGNhbk1vdmU7XG59XG5cbi8qKiovIH0pLFxuLyogMyAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cInVzZSBzdHJpY3RcIjtcblxuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLkVsZW1lbnQgPSB1bmRlZmluZWQ7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbnZhciBfRW1wdHlCbG9jayA9IF9fd2VicGFja19yZXF1aXJlX18oMCk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbnZhciBCTE9DS1MgPSBbW3sgY29vcmQ6IFswLCAwXSwgYm94OiBuZXcgX0VtcHR5QmxvY2suRW1wdHlCbG9jaygpIH0sIHsgY29vcmQ6IFswLCAxXSwgYm94OiBuZXcgX0VtcHR5QmxvY2suRW1wdHlCbG9jaygpIH0sIHsgY29vcmQ6IFswLCAyXSwgYm94OiBuZXcgX0VtcHR5QmxvY2suRW1wdHlCbG9jaygpIH0sIHsgY29vcmQ6IFswLCAzXSwgYm94OiBuZXcgX0VtcHR5QmxvY2suRW1wdHlCbG9jaygpIH1dLCBbeyBjb29yZDogWzAsIDBdLCBib3g6IG5ldyBfRW1wdHlCbG9jay5FbXB0eUJsb2NrKCkgfSwgeyBjb29yZDogWzAsIDFdLCBib3g6IG5ldyBfRW1wdHlCbG9jay5FbXB0eUJsb2NrKCkgfSwgeyBjb29yZDogWzAsIDJdLCBib3g6IG5ldyBfRW1wdHlCbG9jay5FbXB0eUJsb2NrKCkgfSwgeyBjb29yZDogWzEsIDJdLCBib3g6IG5ldyBfRW1wdHlCbG9jay5FbXB0eUJsb2NrKCkgfV0sIFt7IGNvb3JkOiBbMCwgMF0sIGJveDogbmV3IF9FbXB0eUJsb2NrLkVtcHR5QmxvY2soKSB9LCB7IGNvb3JkOiBbMCwgMV0sIGJveDogbmV3IF9FbXB0eUJsb2NrLkVtcHR5QmxvY2soKSB9LCB7IGNvb3JkOiBbMCwgMl0sIGJveDogbmV3IF9FbXB0eUJsb2NrLkVtcHR5QmxvY2soKSB9LCB7IGNvb3JkOiBbMSwgMF0sIGJveDogbmV3IF9FbXB0eUJsb2NrLkVtcHR5QmxvY2soKSB9XSwgW3sgY29vcmQ6IFswLCAwXSwgYm94OiBuZXcgX0VtcHR5QmxvY2suRW1wdHlCbG9jaygpIH0sIHsgY29vcmQ6IFswLCAxXSwgYm94OiBuZXcgX0VtcHR5QmxvY2suRW1wdHlCbG9jaygpIH0sIHsgY29vcmQ6IFsxLCAwXSwgYm94OiBuZXcgX0VtcHR5QmxvY2suRW1wdHlCbG9jaygpIH0sIHsgY29vcmQ6IFsxLCAxXSwgYm94OiBuZXcgX0VtcHR5QmxvY2suRW1wdHlCbG9jaygpIH1dLCBbeyBjb29yZDogWzAsIDFdLCBib3g6IG5ldyBfRW1wdHlCbG9jay5FbXB0eUJsb2NrKCkgfSwgeyBjb29yZDogWzAsIDJdLCBib3g6IG5ldyBfRW1wdHlCbG9jay5FbXB0eUJsb2NrKCkgfSwgeyBjb29yZDogWzEsIDBdLCBib3g6IG5ldyBfRW1wdHlCbG9jay5FbXB0eUJsb2NrKCkgfSwgeyBjb29yZDogWzEsIDFdLCBib3g6IG5ldyBfRW1wdHlCbG9jay5FbXB0eUJsb2NrKCkgfV0sIFt7IGNvb3JkOiBbMCwgMF0sIGJveDogbmV3IF9FbXB0eUJsb2NrLkVtcHR5QmxvY2soKSB9LCB7IGNvb3JkOiBbMCwgMV0sIGJveDogbmV3IF9FbXB0eUJsb2NrLkVtcHR5QmxvY2soKSB9LCB7IGNvb3JkOiBbMCwgMl0sIGJveDogbmV3IF9FbXB0eUJsb2NrLkVtcHR5QmxvY2soKSB9LCB7IGNvb3JkOiBbMSwgMV0sIGJveDogbmV3IF9FbXB0eUJsb2NrLkVtcHR5QmxvY2soKSB9XSwgW3sgY29vcmQ6IFswLCAwXSwgYm94OiBuZXcgX0VtcHR5QmxvY2suRW1wdHlCbG9jaygpIH0sIHsgY29vcmQ6IFswLCAxXSwgYm94OiBuZXcgX0VtcHR5QmxvY2suRW1wdHlCbG9jaygpIH0sIHsgY29vcmQ6IFsxLCAxXSwgYm94OiBuZXcgX0VtcHR5QmxvY2suRW1wdHlCbG9jaygpIH0sIHsgY29vcmQ6IFsxLCAyXSwgYm94OiBuZXcgX0VtcHR5QmxvY2suRW1wdHlCbG9jaygpIH1dXTtcblxudmFyIEVsZW1lbnQgPSBleHBvcnRzLkVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gRWxlbWVudCgpIHtcbiAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEVsZW1lbnQpO1xuXG4gICAgICAgIHRoaXMuaW5kZXggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA3KSwgdGhpcy5ibG9jayA9IEJMT0NLU1t0aGlzLmluZGV4XTtcbiAgICB9XG5cbiAgICBfY3JlYXRlQ2xhc3MoRWxlbWVudCwgW3tcbiAgICAgICAga2V5OiAncGFpbnRMYXN0RWxlbWVudCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBwYWludExhc3RFbGVtZW50KCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgICAgICAgICAgdGhpcy5ibG9jay5tYXAoZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX0VtcHR5QmxvY2suRW1wdHlCbG9jay5jaGFuZ2VCbG9ja1N0eWxlKGl0ZW0uYm94LmJveCwgX3RoaXMuaW5kZXgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBmdW5jdGlvbiBhZGROZXdFbGVtZW50KCkge1xuICAgICAgICAvLyAgICAgbGV0IG5ld0VsZW0gPSBnZXRSYW5kb21FbGVtZW50KCksXG4gICAgICAgIC8vICAgICAgICAgcG9pbnRzWE9mTmV3RWxlbSA9IG5ld0VsZW0uYmxvY2subWFwKGl0ZW0gPT4gaXRlbVsxXSksXG4gICAgICAgIC8vICAgICAgICAgbWlkZGxlID0gTWF0aC5mbG9vcigoYm9hcmQubnVtYmVyT2ZCbG9ja3MgLSBNYXRoLm1heCguLi5wb2ludHNYT2ZOZXdFbGVtKSkgLyAyKTtcbiAgICAgICAgLy9cbiAgICAgICAgLy8gICAgIGZ1bmN0aW9uIGNhbkFkZEFub3RoZXJCbG9jayhlbGVtZW50KSB7XG4gICAgICAgIC8vICAgICAgICAgbGV0IGNhbkFkZCA9IHRydWU7XG4gICAgICAgIC8vXG4gICAgICAgIC8vICAgICAgICAgZWxlbWVudC5ibG9jay5mb3JFYWNoKGl0ZW0gPT4gY2FuQWRkID0gY2FuQWRkICYmIHRyeUFkZEJsb2NrKGl0ZW0pKTtcbiAgICAgICAgLy9cbiAgICAgICAgLy8gICAgICAgICByZXR1cm4gY2FuQWRkO1xuICAgICAgICAvLyAgICAgfVxuICAgICAgICAvL1xuICAgICAgICAvL1xuICAgICAgICAvL1xuICAgICAgICAvLyAgICAgbmV3RWxlbS5ibG9jayA9IG5ld0VsZW0uYmxvY2subWFwKGl0ZW0gPT4gW2l0ZW1bMF0sIGl0ZW1bMV0gKyBtaWRkbGVdKTtcbiAgICAgICAgLy8gfVxuXG4gICAgfV0pO1xuXG4gICAgcmV0dXJuIEVsZW1lbnQ7XG59KCk7XG5cbi8qKiovIH0pXG4vKioqKioqLyBdKTtcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gZGlzdC9idW5kbGUuanMiLCIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHtcbiBcdFx0XHRcdGNvbmZpZ3VyYWJsZTogZmFsc2UsXG4gXHRcdFx0XHRlbnVtZXJhYmxlOiB0cnVlLFxuIFx0XHRcdFx0Z2V0OiBnZXR0ZXJcbiBcdFx0XHR9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAyKTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyB3ZWJwYWNrL2Jvb3RzdHJhcCA5OGI0NTMyZGIyMmI1OTc5MjBlOCIsImltcG9ydCB7R2FtZUJvYXJkfSBmcm9tICcuL0dhbWVCb2FyZC5jbGFzcyc7XG5cbmV4cG9ydCBjbGFzcyBFbXB0eUJsb2NrIHtcbiAgICBjb25zdHJ1Y3Rvcihib2FyZFNpemUsIG51bWJlck9mQmxvY2tzKSB7XG4gICAgICAgIHRoaXMuYm94ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIHRoaXMuYm94LmNsYXNzTmFtZSA9ICdibG9jay1lbXB0eSc7XG4gICAgICAgIHRoaXMuYm94LnN0eWxlLndpZHRoID0gdGhpcy5ib3guc3R5bGUuaGVpZ2h0ID0gKGJvYXJkU2l6ZSAvIG51bWJlck9mQmxvY2tzKS50b0ZpeGVkKDEpICsgJ3B4JztcbiAgICB9XG5cbiAgICBzdGF0aWMgY2hhbmdlQmxvY2tTdHlsZShibG9ja09uUGFnZSwgc3R5bGVCbG9jaykge1xuICAgICAgICBsZXQgZWxDbGFzcywgY29sb3I7XG5cbiAgICAgICAgc3dpdGNoKHN0eWxlQmxvY2spIHtcbiAgICAgICAgY2FzZSAwOiBlbENsYXNzID0gJ2Jsb2NrLWknOyBjb2xvciA9ICcjODFGN0YzJzsgYnJlYWs7XG4gICAgICAgIGNhc2UgMTogZWxDbGFzcyA9ICdibG9jay1qJzsgY29sb3IgPSAnIzgxODFGNyc7IGJyZWFrO1xuICAgICAgICBjYXNlIDI6IGVsQ2xhc3MgPSAnYmxvY2stbCc7IGNvbG9yID0gJyNGRTlBMkUnOyBicmVhaztcbiAgICAgICAgY2FzZSAzOiBlbENsYXNzID0gJ2Jsb2NrLW8nOyBjb2xvciA9ICcjRjNGNzgxJzsgYnJlYWs7XG4gICAgICAgIGNhc2UgNDogZWxDbGFzcyA9ICdibG9jay1zJzsgY29sb3IgPSAnIzgxRjc4MSc7IGJyZWFrO1xuICAgICAgICBjYXNlIDU6IGVsQ2xhc3MgPSAnYmxvY2stdCc7IGNvbG9yID0gJyNEQTgxRjUnOyBicmVhaztcbiAgICAgICAgY2FzZSA2OiBlbENsYXNzID0gJ2Jsb2NrLXonOyBjb2xvciA9ICcjRjc4MTgxJzsgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6IGVsQ2xhc3MgPSAnYmxvY2stZW1wdHknOyBjb2xvciA9ICcjRDhEOEQ4JztcbiAgICAgICAgfVxuXG4gICAgICAgIGJsb2NrT25QYWdlLmNsYXNzTmFtZSA9IGVsQ2xhc3M7XG4gICAgICAgIGJsb2NrT25QYWdlLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGNvbG9yO1xuICAgIH1cbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NjcmlwdHMvRW1wdHlCbG9jay5jbGFzcy5qcyIsImV4cG9ydCBjbGFzcyBHYW1lQm9hcmQge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLm51bWJlck9mQmxvY2tzID0gdGhpcy5jaGVja0lucHV0VmFsdWUoKTtcbiAgICAgICAgdGhpcy5nYW1lQm9hcmRTaXplID0gNTUwO1xuICAgICAgICB0aGlzLm1pblNwZWVkID0gMTAwMDtcbiAgICAgICAgdGhpcy5zcGVlZFJlZHVjdGlvbiA9IDUwMDtcbiAgICB9XG5cbiAgICBjaGVja0lucHV0VmFsdWUoKSB7XG4gICAgICAgIGxldCB2YWx1ZSA9ICtkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbnVtYmVyJykudmFsdWU7XG5cbiAgICAgICAgcmV0dXJuIHZhbHVlID49IDkgJiYgdmFsdWUgPD0gMTUgPyB2YWx1ZSA6IDk7XG4gICAgfVxufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc2NyaXB0cy9HYW1lQm9hcmQuY2xhc3MuanMiLCJpbXBvcnQge0VsZW1lbnR9IGZyb20gJy4vRWxlbWVudC5jbGFzcyc7XG5pbXBvcnQge0VtcHR5QmxvY2t9IGZyb20gJy4vRW1wdHlCbG9jay5jbGFzcyc7XG5pbXBvcnQge0dhbWVCb2FyZH0gZnJvbSAnLi9HYW1lQm9hcmQuY2xhc3MnO1xuXG5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjc3RhcnQnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGluaXQpO1xuXG5sZXQgYmxvY2tzT25QYWdlLFxuICAgIGVsZW1lbnRzLFxuICAgIGdhbWVCb2FyZCxcbiAgICBpbnRlcnZhbElELFxuICAgIHNjb3JlLFxuICAgIHNjb3JlRWxlbWVudCxcbiAgICBzcGVlZCxcbiAgICB0aGVHYW1lSXNOb3RGaW5pc2hlZCxcbiAgICBib2FyZDtcblxuZnVuY3Rpb24gaW5pdCgpIHtcbiAgICBmdW5jdGlvbiBzdGFydEdhbWUoKSB7XG4gICAgICAgIGZ1bmN0aW9uIGNoZWNrU2NvcmUoKSB7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJsb2Nrc09uUGFnZS5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgICAgIGlmKCFibG9ja3NPblBhZ2VbaV0ubWFwKGl0ZW0gPT4gaXRlbS5jbGFzc05hbWUpLmluY2x1ZGVzKCdibG9jay1lbXB0eScpKSB7XG4gICAgICAgICAgICAgICAgICAgIHNjb3JlICs9IGJvYXJkLm51bWJlck9mQmxvY2tzO1xuICAgICAgICAgICAgICAgICAgICBzY29yZUVsZW1lbnQuaW5uZXJUZXh0ID0gc2NvcmU7XG4gICAgICAgICAgICAgICAgICAgIHNwZWVkID0gc3BlZWQgPT09IGJvYXJkLm1pblNwZWVkID8gc3BlZWQgOiBzcGVlZCAtIGJvYXJkLnNwZWVkUmVkdWN0aW9uO1xuICAgICAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnY3VycmVudFNjb3JlJywgc2NvcmUpO1xuICAgICAgICAgICAgICAgICAgICBlbGVtZW50cy5tYXAoaXRlbSA9PiBkcmF3RWxlbWVudChpdGVtLmJsb2NrKSk7XG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnRzLmZvckVhY2goaXRlbSA9PiBpdGVtLmJsb2NrID0gaXRlbS5ibG9jay5maWx0ZXIoZWxlbSA9PiBlbGVtLmNvb3JkWzBdICE9PSBpKSk7XG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnRzID0gZWxlbWVudHMuZmlsdGVyKGVsZW0gPT4gZWxlbS5ibG9jay5sZW5ndGggIT09IDApO1xuICAgICAgICAgICAgICAgICAgICBlbGVtZW50cy5tYXAoaXRlbSA9PiBkcmF3RWxlbWVudChpdGVtLmJsb2NrLCBpdGVtLmluZGV4KSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaW50ZXJ2YWxJRCA9IHNldEludGVydmFsKCgpID0+IHtcbiAgICAgICAgICAgIGVsZW1lbnRzLmZvckVhY2goKGl0ZW0sIGluZGV4KSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGNhbk1vdmVFbGVtZW50KGl0ZW0uYmxvY2ssIFsxLCAwXSkpIHtcbiAgICAgICAgICAgICAgICAgICAgbW92ZUJsb2NrKGl0ZW0sIDAsIDEpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpbmRleCA9PT0gZWxlbWVudHMubGVuZ3RoIC0gMSAmJiB0aGVHYW1lSXNOb3RGaW5pc2hlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWRkTmV3RWxlbWVudCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNoZWNrU2NvcmUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9LCBzcGVlZCk7XG4gICAgfVxuXG4gICAgaWYgKGdhbWVCb2FyZCB8fCBpbnRlcnZhbElEKSB7XG4gICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoZ2FtZUJvYXJkKTtcbiAgICAgICAgY2xlYXJJbnRlcnZhbChpbnRlcnZhbElEKTtcbiAgICB9XG5cbiAgICBib2FyZCA9IG5ldyBHYW1lQm9hcmQoKTtcbiAgICBibG9ja3NPblBhZ2UgPSBbXTtcbiAgICBlbGVtZW50cyA9IFtdO1xuICAgIHNjb3JlID0gcGFyc2VJbnQobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2N1cnJlbnRTY29yZScpKSB8fCAwO1xuICAgIHNjb3JlRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzY29yZScpO1xuICAgIHNjb3JlRWxlbWVudC5pbm5lclRleHQgPSBzY29yZSB8fCAwO1xuICAgIHNwZWVkID0gMjUwMDtcbiAgICB0aGVHYW1lSXNOb3RGaW5pc2hlZCA9IHRydWU7XG5cbiAgICBkcmF3R2FtZUJvYXJkKCk7XG4gICAgYWRkTmV3RWxlbWVudCgpO1xuICAgIHN0YXJ0R2FtZSgpO1xuXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGV4ZWN1dGVLZXlEb3duQWN0aW9uKTtcbn1cblxuZnVuY3Rpb24gZXhlY3V0ZUtleURvd25BY3Rpb24oZXZlbnQpIHtcbiAgICBpZiAoZXZlbnQua2V5Q29kZSA9PT0gMzcgJiYgY2FuTW92ZUVsZW1lbnQoZWxlbWVudHNbZWxlbWVudHMubGVuZ3RoIC0gMV0uYmxvY2ssIFswLCAtMV0pKSB7XG4gICAgICAgIG1vdmVCbG9jayhlbGVtZW50c1tlbGVtZW50cy5sZW5ndGggLSAxXSwgMSwgLTEpO1xuICAgIH0gZWxzZSBpZiAoZXZlbnQua2V5Q29kZSA9PT0gMzkgJiYgY2FuTW92ZUVsZW1lbnQoZWxlbWVudHNbZWxlbWVudHMubGVuZ3RoIC0gMV0uYmxvY2ssIFswLCAxXSkpIHtcbiAgICAgICAgbW92ZUJsb2NrKGVsZW1lbnRzW2VsZW1lbnRzLmxlbmd0aCAtIDFdLCAxLCAxKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGRyYXdHYW1lQm9hcmQoKSB7XG4gICAgZ2FtZUJvYXJkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgZ2FtZUJvYXJkLmNsYXNzTmFtZSA9ICdnYW1lJztcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYm9hcmQubnVtYmVyT2ZCbG9ja3M7ICsraSkge1xuICAgICAgICBibG9ja3NPblBhZ2UucHVzaChbXSk7XG4gICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgYm9hcmQubnVtYmVyT2ZCbG9ja3M7ICsraikge1xuICAgICAgICAgICAgYmxvY2tzT25QYWdlW2ldW2pdID0gKG5ldyBFbXB0eUJsb2NrKGJvYXJkLmdhbWVCb2FyZFNpemUsIGJvYXJkLm51bWJlck9mQmxvY2tzKSkuYm94O1xuICAgICAgICAgICAgZ2FtZUJvYXJkLmFwcGVuZENoaWxkKGJsb2Nrc09uUGFnZVtpXVtqXSk7XG4gICAgICAgICAgICBFbXB0eUJsb2NrLmNoYW5nZUJsb2NrU3R5bGUoYmxvY2tzT25QYWdlW2ldW2pdKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZ2FtZUJvYXJkKTtcbn1cblxuZnVuY3Rpb24gYWRkTmV3RWxlbWVudCgpIHtcbiAgICBsZXQgbmV3RWxlbSA9IG5ldyBFbGVtZW50KCksXG4gICAgICAgIHBvaW50c1hPZk5ld0VsZW0gPSBuZXdFbGVtLmJsb2NrLm1hcChpdGVtID0+IGl0ZW0uY29vcmRbMV0pLFxuICAgICAgICBtaWRkbGUgPSBNYXRoLmZsb29yKChib2FyZC5udW1iZXJPZkJsb2NrcyAtIE1hdGgubWF4KC4uLnBvaW50c1hPZk5ld0VsZW0pKSAvIDIpO1xuXG4gICAgZnVuY3Rpb24gY2FuQWRkQW5vdGhlckJsb2NrKGVsZW1lbnQpIHtcbiAgICAgICAgbGV0IGNhbkFkZCA9IHRydWU7XG5cbiAgICAgICAgZWxlbWVudC5ibG9jay5mb3JFYWNoKGl0ZW0gPT4gY2FuQWRkID0gY2FuQWRkICYmIHRyeUFkZEJsb2NrKGl0ZW0uY29vcmQpKTtcblxuICAgICAgICByZXR1cm4gY2FuQWRkO1xuICAgIH1cblxuICAgIG5ld0VsZW0uYmxvY2sgPSBuZXdFbGVtLmJsb2NrLm1hcChpdGVtID0+IHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGJveDogaXRlbS5ib3gsXG4gICAgICAgICAgICBjb29yZDogW2l0ZW0uY29vcmRbMF0sIGl0ZW0uY29vcmRbMV0gKyBtaWRkbGVdXG4gICAgICAgIH07XG4gICAgfSk7XG5cbiAgICBpZiAoY2FuQWRkQW5vdGhlckJsb2NrKG5ld0VsZW0pKSB7XG4gICAgICAgIGVsZW1lbnRzLnB1c2gobmV3RWxlbSk7XG4gICAgICAgIGRyYXdFbGVtZW50KGVsZW1lbnRzW2VsZW1lbnRzLmxlbmd0aCAtIDFdLmJsb2NrLCBlbGVtZW50c1tlbGVtZW50cy5sZW5ndGggLSAxXS5pbmRleCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGV4ZWN1dGVLZXlEb3duQWN0aW9uKTtcbiAgICAgICAgbmV3RWxlbS5wYWludExhc3RFbGVtZW50KCk7XG4gICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCdjdXJyZW50U2NvcmUnKTtcbiAgICAgICAgdGhlR2FtZUlzTm90RmluaXNoZWQgPSBmYWxzZTtcbiAgICAgICAgY2xlYXJJbnRlcnZhbChpbnRlcnZhbElEKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHRyeUFkZEJsb2NrKGJsb2NrKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgcmV0dXJuIGJsb2Nrc09uUGFnZVtibG9ja1swXV1bYmxvY2tbMV1dLmNsYXNzTmFtZSA9PT0gJ2Jsb2NrLWVtcHR5JztcbiAgICB9IGNhdGNoKGVycikge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBkcmF3RWxlbWVudChibG9jaywgaW5kZXgpIHtcbiAgICBibG9jay5tYXAoaXRlbSA9PiB7XG4gICAgICAgIEVtcHR5QmxvY2suY2hhbmdlQmxvY2tTdHlsZShibG9ja3NPblBhZ2VbaXRlbS5jb29yZFswXV1baXRlbS5jb29yZFsxXV0sIGluZGV4KTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gbW92ZUJsb2NrKGVsZW1lbnQsIHBvc2l0aW9uLCBzaGlmdCkge1xuICAgIGRyYXdFbGVtZW50KGVsZW1lbnQuYmxvY2spO1xuICAgIGVsZW1lbnQuYmxvY2subWFwKGl0ZW0gPT4gaXRlbS5jb29yZFtwb3NpdGlvbl0gKz0gc2hpZnQpO1xuICAgIGRyYXdFbGVtZW50KGVsZW1lbnQuYmxvY2ssIGVsZW1lbnQuaW5kZXgpO1xufVxuXG5mdW5jdGlvbiBjYW5Nb3ZlRWxlbWVudChibG9jaywgc2hpZnQpIHtcbiAgICBsZXQgcGVyaGFic05ld1Bvc2l0aW9uID0gYmxvY2subWFwKGl0ZW0gPT4gW2l0ZW0uY29vcmRbMF0gKyBzaGlmdFswXSwgaXRlbS5jb29yZFsxXSArIHNoaWZ0WzFdXSksXG4gICAgICAgIGNhbk1vdmUgPSB0cnVlO1xuXG4gICAgcGVyaGFic05ld1Bvc2l0aW9uLmZvckVhY2goaXRlbSA9PiB7XG4gICAgICAgIGlmICghYmxvY2subWFwKGl0ZW0gPT4gaXRlbS5jb29yZC50b1N0cmluZygpKS5pbmNsdWRlcyhpdGVtLnRvU3RyaW5nKCkpKSB7XG4gICAgICAgICAgICBjYW5Nb3ZlID0gY2FuTW92ZSAmJiB0cnlBZGRCbG9jayhpdGVtKTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIGNhbk1vdmU7XG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zY3JpcHRzL2luZGV4LmpzIiwiaW1wb3J0IHtFbXB0eUJsb2NrfSBmcm9tICcuL0VtcHR5QmxvY2suY2xhc3MnO1xuXG5jb25zdCBCTE9DS1MgPSBbW1xuICAgIHtjb29yZDogWzAsIDBdLCBib3g6IG5ldyBFbXB0eUJsb2NrKCl9LFxuICAgIHtjb29yZDogWzAsIDFdLCBib3g6IG5ldyBFbXB0eUJsb2NrKCl9LFxuICAgIHtjb29yZDogWzAsIDJdLCBib3g6IG5ldyBFbXB0eUJsb2NrKCl9LFxuICAgIHtjb29yZDogWzAsIDNdLCBib3g6IG5ldyBFbXB0eUJsb2NrKCl9XG5dLCBbXG4gICAge2Nvb3JkOiBbMCwgMF0sIGJveDogbmV3IEVtcHR5QmxvY2soKX0sXG4gICAge2Nvb3JkOiBbMCwgMV0sIGJveDogbmV3IEVtcHR5QmxvY2soKX0sXG4gICAge2Nvb3JkOiBbMCwgMl0sIGJveDogbmV3IEVtcHR5QmxvY2soKX0sXG4gICAge2Nvb3JkOiBbMSwgMl0sIGJveDogbmV3IEVtcHR5QmxvY2soKX1cbl0sIFtcbiAgICB7Y29vcmQ6IFswLCAwXSwgYm94OiBuZXcgRW1wdHlCbG9jaygpfSxcbiAgICB7Y29vcmQ6IFswLCAxXSwgYm94OiBuZXcgRW1wdHlCbG9jaygpfSxcbiAgICB7Y29vcmQ6IFswLCAyXSwgYm94OiBuZXcgRW1wdHlCbG9jaygpfSxcbiAgICB7Y29vcmQ6IFsxLCAwXSwgYm94OiBuZXcgRW1wdHlCbG9jaygpfVxuXSwgW1xuICAgIHtjb29yZDogWzAsIDBdLCBib3g6IG5ldyBFbXB0eUJsb2NrKCl9LFxuICAgIHtjb29yZDogWzAsIDFdLCBib3g6IG5ldyBFbXB0eUJsb2NrKCl9LFxuICAgIHtjb29yZDogWzEsIDBdLCBib3g6IG5ldyBFbXB0eUJsb2NrKCl9LFxuICAgIHtjb29yZDogWzEsIDFdLCBib3g6IG5ldyBFbXB0eUJsb2NrKCl9XG5dLCBbXG4gICAge2Nvb3JkOiBbMCwgMV0sIGJveDogbmV3IEVtcHR5QmxvY2soKX0sXG4gICAge2Nvb3JkOiBbMCwgMl0sIGJveDogbmV3IEVtcHR5QmxvY2soKX0sXG4gICAge2Nvb3JkOiBbMSwgMF0sIGJveDogbmV3IEVtcHR5QmxvY2soKX0sXG4gICAge2Nvb3JkOiBbMSwgMV0sIGJveDogbmV3IEVtcHR5QmxvY2soKX1cbl0sIFtcbiAgICB7Y29vcmQ6IFswLCAwXSwgYm94OiBuZXcgRW1wdHlCbG9jaygpfSxcbiAgICB7Y29vcmQ6IFswLCAxXSwgYm94OiBuZXcgRW1wdHlCbG9jaygpfSxcbiAgICB7Y29vcmQ6IFswLCAyXSwgYm94OiBuZXcgRW1wdHlCbG9jaygpfSxcbiAgICB7Y29vcmQ6IFsxLCAxXSwgYm94OiBuZXcgRW1wdHlCbG9jaygpfVxuXSwgW1xuICAgIHtjb29yZDogWzAsIDBdLCBib3g6IG5ldyBFbXB0eUJsb2NrKCl9LFxuICAgIHtjb29yZDogWzAsIDFdLCBib3g6IG5ldyBFbXB0eUJsb2NrKCl9LFxuICAgIHtjb29yZDogWzEsIDFdLCBib3g6IG5ldyBFbXB0eUJsb2NrKCl9LFxuICAgIHtjb29yZDogWzEsIDJdLCBib3g6IG5ldyBFbXB0eUJsb2NrKCl9XG5dXTtcblxuZXhwb3J0IGNsYXNzIEVsZW1lbnQge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLmluZGV4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNyksXG4gICAgICAgIHRoaXMuYmxvY2sgPSBCTE9DS1NbdGhpcy5pbmRleF07XG4gICAgfVxuXG4gICAgcGFpbnRMYXN0RWxlbWVudCgpIHtcbiAgICAgICAgdGhpcy5ibG9jay5tYXAoaXRlbSA9PiBFbXB0eUJsb2NrLmNoYW5nZUJsb2NrU3R5bGUoaXRlbS5ib3guYm94LCB0aGlzLmluZGV4KSk7XG4gICAgfVxuXG4gICAgLy8gZnVuY3Rpb24gYWRkTmV3RWxlbWVudCgpIHtcbiAgICAvLyAgICAgbGV0IG5ld0VsZW0gPSBnZXRSYW5kb21FbGVtZW50KCksXG4gICAgLy8gICAgICAgICBwb2ludHNYT2ZOZXdFbGVtID0gbmV3RWxlbS5ibG9jay5tYXAoaXRlbSA9PiBpdGVtWzFdKSxcbiAgICAvLyAgICAgICAgIG1pZGRsZSA9IE1hdGguZmxvb3IoKGJvYXJkLm51bWJlck9mQmxvY2tzIC0gTWF0aC5tYXgoLi4ucG9pbnRzWE9mTmV3RWxlbSkpIC8gMik7XG4gICAgLy9cbiAgICAvLyAgICAgZnVuY3Rpb24gY2FuQWRkQW5vdGhlckJsb2NrKGVsZW1lbnQpIHtcbiAgICAvLyAgICAgICAgIGxldCBjYW5BZGQgPSB0cnVlO1xuICAgIC8vXG4gICAgLy8gICAgICAgICBlbGVtZW50LmJsb2NrLmZvckVhY2goaXRlbSA9PiBjYW5BZGQgPSBjYW5BZGQgJiYgdHJ5QWRkQmxvY2soaXRlbSkpO1xuICAgIC8vXG4gICAgLy8gICAgICAgICByZXR1cm4gY2FuQWRkO1xuICAgIC8vICAgICB9XG4gICAgLy9cbiAgICAvL1xuICAgIC8vXG4gICAgLy8gICAgIG5ld0VsZW0uYmxvY2sgPSBuZXdFbGVtLmJsb2NrLm1hcChpdGVtID0+IFtpdGVtWzBdLCBpdGVtWzFdICsgbWlkZGxlXSk7XG4gICAgLy8gfVxufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc2NyaXB0cy9FbGVtZW50LmNsYXNzLmpzIl0sInNvdXJjZVJvb3QiOiIifQ==